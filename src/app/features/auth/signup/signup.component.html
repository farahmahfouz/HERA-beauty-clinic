<app-modal #modal (closeModal)="onCloseModal()">
    <form class="lg:px-6 w-full max-w-md space-y-4" [formGroup]="form" (ngSubmit)="onSubmit()">
        <h2 class="text-2xl font-bold text-center">Create Account</h2>

        <!-- Name -->
        <app-control label="Name">
            <input type="text" placeholder="Your name" formControlName="name" autocomplete="name" />
            <small class="text-red-500 text-sm" *ngIf="nameErrors">
                <span *ngIf="nameErrors['required']">Name is required</span>
                <span *ngIf="nameErrors['server']">{{ nameErrors['server'] }}</span>
            </small>
        </app-control>

        <!-- Username -->
        <app-control label="Username">
            <input type="text" placeholder="yourusername" formControlName="username" autocomplete="username" />
            <small class="text-red-500 text-sm" *ngIf="usernameErrors">
                <span *ngIf="usernameErrors['required']">Username is required</span>
                <span *ngIf="usernameErrors['minlength']">Username must be at least 4 characters</span>
                <span *ngIf="usernameErrors['server']">{{ usernameErrors['server'] }}</span>
            </small>
        </app-control>

        <!-- Email -->
        <app-control label="Email">
            <input type="email" placeholder="you@example.com" formControlName="email" autocomplete="email" />
            <small class="text-red-500 text-sm" *ngIf="emailErrors">
                <span *ngIf="emailErrors['required']">Email is required</span>
                <span *ngIf="emailErrors['email']">Please enter a valid email</span>
                <span *ngIf="emailErrors['server']">{{ emailErrors['server'] }}</span>
            </small>
        </app-control>

        <!-- Password -->
        <app-control label="Password">
            <input type="password" placeholder="********" formControlName="password" autocomplete="new-password" />
            <small class="text-red-500 text-sm" *ngIf="passwordErrors">
                <span *ngIf="passwordErrors['required']">Password is required</span>
                <span *ngIf="passwordErrors['minlength']">Password must be at least 8 characters</span>
                <span *ngIf="passwordErrors['server']">{{ passwordErrors['server'] }}</span>
            </small>
        </app-control>

        <!-- Phone -->
        <app-control label="Phone">
            <input type="text" placeholder="+201234567890" formControlName="phone" />
            <p class="text-xs text-gray-500 mt-1">Must start with +20 and contain 10 digits</p>
            <small class="text-red-500 text-sm" *ngIf="phoneErrors">
                <span *ngIf="phoneErrors['required']">Phone number is required</span>
                <span *ngIf="phoneErrors['pattern']">Phone must start with +20 and contain 10 digits</span>
                <span *ngIf="phoneErrors['server']">{{ phoneErrors['server'] }}</span>
            </small>
        </app-control>

        <!-- General API error -->
        <small class="text-red-500 text-sm" *ngIf="apiError">{{ apiError }}</small>

        <!-- Submit -->
        <button type="submit" appButton variant="primary" [disabled]="isLoading" class="w-full">
            @if(isLoading){
            <span class="loading loading-spinner loading-sm pe-0.5"></span>
            <span>Loading...</span>
            } @else {
            <span>Sign Up</span>
            }
        </button>
    </form>
</app-modal>